openapi: 3.1.0
info:
  title: Notion Course Creator API
  description: API pour cr√©er des cours dans Notion depuis ChatGPT.
  version: 2.0.0
servers:
  - url: https://notion-course-api.onrender.com

paths:
  /health:
    get:
      operationId: healthCheck
      summary: V√©rifier le statut de l'API
      responses:
        '200':
          description: OK

  /api/search:
    post:
      operationId: search
      summary: Rechercher pages et databases dans Notion
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                query:
                  type: string
      responses:
        '200':
          description: R√©sultats de recherche

  /api/search-pages:
    post:
      operationId: searchPages
      summary: Rechercher uniquement des pages
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                query:
                  type: string
      responses:
        '200':
          description: Pages trouv√©es

  /api/search-databases:
    post:
      operationId: searchDatabases
      summary: Rechercher uniquement des databases
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                query:
                  type: string
      responses:
        '200':
          description: Databases trouv√©es

  /api/page/{pageId}:
    get:
      operationId: getPage
      summary: R√©cup√©rer une page
      parameters:
        - name: pageId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Page Notion
    patch:
      operationId: updatePage
      summary: Mettre √† jour une page
      parameters:
        - name: pageId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                properties:
                  type: object
      responses:
        '200':
          description: Page mise √† jour

  /api/page/{pageId}/blocks:
    get:
      operationId: getPageBlocks
      summary: R√©cup√©rer le contenu d'une page
      parameters:
        - name: pageId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Blocs de la page

  /api/page/{pageId}/append:
    post:
      operationId: appendBlocks
      summary: Ajouter du contenu √† une page
      parameters:
        - name: pageId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [blocks]
              properties:
                blocks:
                  type: array
                  items:
                    type: object
      responses:
        '200':
          description: Blocs ajout√©s

  /api/database/{databaseId}:
    get:
      operationId: getDatabase
      summary: R√©cup√©rer une database
      parameters:
        - name: databaseId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Database Notion

  /api/create-simple-page:
    post:
      operationId: createSimplePage
      summary: Cr√©er une page simple
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [parentId, title]
              properties:
                parentId:
                  type: string
                title:
                  type: string
                content:
                  type: string
      responses:
        '200':
          description: Page cr√©√©e

  /api/create-course:
    post:
      operationId: createCourse
      summary: Cr√©er un cours complet dans Notion
      description: Cr√©e un cours avec sections et blocs. Appeler /api/block-types pour voir les types disponibles.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [parentId, title, sections]
              properties:
                parentId:
                  type: string
                  description: ID de la page parent Notion
                title:
                  type: string
                icon:
                  type: string
                  description: Emoji (ex üìò)
                cover:
                  type: string
                  description: URL image de couverture
                description:
                  type: string
                estimatedTime:
                  type: integer
                  description: Minutes
                prerequisites:
                  type: array
                  items:
                    type: string
                objectives:
                  type: array
                  items:
                    type: string
                sections:
                  type: array
                  items:
                    type: object
                    required: [title, content]
                    properties:
                      title:
                        type: string
                      description:
                        type: string
                      color:
                        type: string
                      content:
                        type: array
                        items:
                          type: object
                          properties:
                            type:
                              type: string
                            text:
                              type: string
                            items:
                              type: array
                              items:
                                type: string
                            code:
                              type: string
                            language:
                              type: string
                            url:
                              type: string
                            icon:
                              type: string
                            color:
                              type: string
                            question:
                              type: string
                            options:
                              type: array
                              items:
                                type: string
                            correctIndex:
                              type: integer
                            term:
                              type: string
                            definition:
                              type: string
                            stepNumber:
                              type: integer
                            instructions:
                              type: array
                              items:
                                type: string
                            solution:
                              type: string
                            minutes:
                              type: integer
      responses:
        '200':
          description: Cours cr√©√©

  /api/block-types:
    get:
      operationId: getBlockTypes
      summary: Liste des types de blocs disponibles avec exemples
      responses:
        '200':
          description: Types de blocs et exemples
